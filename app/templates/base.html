<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    {% if title %}
    <title>{{ config.TITLE }} - {{ title }}</title>
    {% else %}
    <title>Welcome to My Sandbox</title>
    {% endif %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" 
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Big+Shoulders+Stencil+Display:wght@900&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Big+Shoulders+Stencil+Display:wght@900&display=swap" rel="stylesheet"></noscript>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" media="print" onload="this.media='all'">
  <noscript><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"></noscript>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@5.9.55/css/materialdesignicons.min.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    /* Server-side rendered variable from Flask */
    window.SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
  </script>
  <script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
  </script>
  <script 
    src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" 
    integrity="sha512-qTXRIMyZIFb8iQcfjXWCO8+M5Tbc38Qi5WzdPOYZHIlZpzBHG3L3by84BBBOiRGiEb7KKtAOAs5qYdUiZiQNNQ==" 
    crossorigin="anonymous">
  </script>
  {% block extra_css %}
  <style>
    .account-user-avatar img {
      border-radius: 50%;
    }
    .nav-user {
      display: flex;
      align-items: center;
      padding: 0.5rem 1rem;
    }
    .nav-user .account-user-avatar {
      margin-right: 0.5rem;
    }
    /* Force email and date to show on all screen sizes */
    .nav-user .account-user-name {
      display: block !important;
      font-weight: 600;
      margin-right: 0.5rem;
    }
    .nav-user .account-position {
      display: block !important;
      font-size: 12px;
    }
    .nav-user > span:last-child {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .account-position {
      font-size: 0.75rem;
      color: #6c757d;
      margin-top: 0.125rem;
    }
    .topbar-dropdown-menu {
      min-width: 180px;
    }
    .noti-title h6 {
      font-size: 0.875rem;
      font-weight: 600;
      margin-bottom: 0;
    }
    .notify-item {
      padding: 0.5rem 1rem;
      display: flex;
      align-items: center;
    }
    .notify-item i {
      font-size: 1rem;
      margin-right: 0.5rem;
    }
  </style>
  {% endblock %}
</head>
<body>
    <nav role="navigation" class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <a class="navbar-brand" href="#">{{ config.TITLE }}</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav mr-auto">
            <li class="{{ 'nav-item active' if active_page == 'index' else 'nav-item' }}">
              <a class="nav-link" href="{{ url_for('index') }}">Home</a>
            </li>
          </ul>
          {% if not current_user.is_anonymous %}
          <ul class="navbar-nav mr-auto">
            <li class="{{ 'nav-item active' if active_page == 'today' else 'nav-item' }}">
              <a class="nav-link" href="{{ url_for('list', id='today') }}">Today</a>
            </li>
            <li class="{{ 'nav-item active' if active_page == 'tomorrow' else 'nav-item' }}">
              <a class="nav-link" href="{{ url_for('list', id='tomorrow') }}">Tomorrow</a>
            </li>
            <li class="{{ 'nav-item active' if active_page == 'Undone Tasks' else 'nav-item' }}">
              <a class="nav-link" href="{{ url_for('undone') }}">Undone Tasks</a>
            </li>
          </ul>
          {% endif %}
        </div>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto nav-flex-icons w-auto">
              <li class="nav-item dropdown notification-list">
                {% if current_user.is_anonymous %}
                <a class="nav-link" href="{{ url_for('login') }}">
                  <i class="fas fa-user p-2"></i>
                  Sign In
                </a>
                {% else %}
                <a class="nav-link dropdown-toggle nav-user arrow-none mr-0" href="#" id="topbar-userdrop" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                  <span class="account-user-avatar">
                    <img src="https://www.gravatar.com/avatar/e4f36b24bbefaf33264699d4be5e1d0a?s=32&amp;d=identicon" alt="user-avatar" class="rounded-circle" style="width: 32px; height: 32px;" referrerpolicy="no-referrer">
                  </span>
                  <span class="account-user-name">{{ current_user.email }}</span>
                  <span class="account-position" id="current-date"></span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-menu-animated topbar-dropdown-menu profile-dropdown" aria-labelledby="topbar-userdrop">
                  <div class="dropdown-header noti-title">
                    <h6 class="text-overflow m-0">Welcome !</h6>
                  </div>
                  <a href="{{ url_for('account') }}" class="dropdown-item notify-item">
                    <i class="mdi mdi-account-circle mr-1"></i>
                    <span>My Account</span>
                  </a>
                  <a href="{{ url_for('settings') }}" class="dropdown-item notify-item">
                    <i class="mdi mdi-account-edit mr-1"></i>
                    <span>Settings</span>
                  </a>
                  
                  <!-- item - sharing (Gmail users only) -->
                  {% if current_user.is_gmail_user() %}
                  <a href="{{ url_for('sharing') }}" class="dropdown-item notify-item">
                    <i class="mdi mdi-share-variant mr-1"></i>
                    <span>Sharing</span>
                  </a>
                  {% endif %}
                  <a href="{{ url_for('logout') }}" class="dropdown-item notify-item">
                    <i class="mdi mdi-logout mr-1"></i>
                    <span>Logout</span>
                  </a>
                </div>
                {% endif %}
              </li>
            </ul>
          </div>
      </nav>
      <ol class="breadcrumb mt-4 pt-3">
        <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Home</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{ active_page|title }}</li>
      </ol>
    {% block content %}{% endblock %}
    {% block footer %}{% endblock %}

</body>

<script 
  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" 
  integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" 
  crossorigin="anonymous">
</script>

{% block extra_script %}
<script>
  // Update current date display
  function updateCurrentDate() {
    const now = new Date();
    const options = { 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric' 
    };
    const dateString = now.toLocaleDateString('en-US', options);
    document.getElementById('current-date').textContent = dateString;
  }
  
  // Update date on page load
  updateCurrentDate();
  
  // Update date every minute
  setInterval(updateCurrentDate, 60000);
</script>
{% endblock %}
</html>